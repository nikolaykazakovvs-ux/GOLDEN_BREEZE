# Golden Breeze - Training Pipeline v1.1

**–ü–æ–ª–Ω—ã–π –∫–æ–Ω–≤–µ–π–µ—Ä –æ–±—É—á–µ–Ω–∏—è:** MT5 Data Export ‚Üí Label Generation ‚Üí Dataset Preparation ‚Üí LSTM Training ‚Üí Backtest

**–í–µ—Ä—Å–∏—è:** 1.1  
**–î–∞—Ç–∞:** 2025-01-30  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ COMPLETE

---

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä](#–æ–±–∑–æ—Ä)
2. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω–≤–µ–π–µ—Ä–∞](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-–∫–æ–Ω–≤–µ–π–µ—Ä–∞)
3. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)
4. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
5. [–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è](#–¥–µ—Ç–∞–ª—å–Ω–∞—è-–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è)
6. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–¥–∞–Ω–Ω—ã—Ö)
7. [–ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞](#–º–µ—Ç—Ä–∏–∫–∏-–∏-–æ—Ü–µ–Ω–∫–∞)
8. [Troubleshooting](#troubleshooting)

---

## üéØ –û–±–∑–æ—Ä

Training Pipeline v1.1 ‚Äî —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è Direction LSTM –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–π–¥–∞—Ö –∏–∑ HybridStrategy.

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ MetaTrader 5
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫ –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–π–¥–æ–≤ HybridStrategy (–Ω–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏–≥–Ω–∞–ª–æ–≤)
- ‚úÖ Feature engineering: 11 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è StandardScaler (per-feature)
- ‚úÖ Stratified splits –¥–ª—è –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∏ –∫–ª–∞—Å—Å–æ–≤
- ‚úÖ LSTM —Å early stopping (MCC –º–µ—Ç—Ä–∏–∫–∞)
- ‚úÖ CUDA support (RTX 3070 ready)
- ‚úÖ –ü–æ–ª–Ω–∞—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å (seed=42)
- ‚úÖ –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç—á—ë—Ç—ã

**–ß—Ç–æ –ù–ï –ª–æ–º–∞–µ—Ç—Å—è:**
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π HybridStrategy –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- BacktestEngine –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –µ—Å—Ç—å
- TimeframeSelector –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç—Å—è
- AI Core v2.0 —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–Ω–≤–µ–π–µ—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    TRAINING PIPELINE v1.1                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Step 1: Data Export
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  MT5 Server  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ get_ohlcv()
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ export_mt5_history.py‚îÇ
‚îÇ  M1, M5, M15, H1, H4 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
data/raw/{symbol}/{tf}.csv

Step 2: Label Generation
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ data/raw/XAUUSD/ ‚îÇ
‚îÇ  M1, M5, ..., H4 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ generate_labels.py  ‚îÇ
‚îÇ  - Load multitf data‚îÇ
‚îÇ  - Run HybridStrategy‚îÇ
‚îÇ  - Extract trades   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
data/labels/direction_labels.csv
(timestamp, regime, direction_label, pnl, prices)

Step 3: Dataset Preparation
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ direction_labels   ‚îÇ
‚îÇ    + OHLCV M5      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ prepare_direction_dataset ‚îÇ
‚îÇ  - Add 11 features        ‚îÇ
‚îÇ  - Create sequences       ‚îÇ
‚îÇ  - Normalize (StandardScaler)‚îÇ
‚îÇ  - Train/Val/Test split   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
data/prepared/direction_dataset.npz
(X_train, y_train, X_val, y_val, X_test, y_test, scaler_params)

Step 4: LSTM Training
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ direction_dataset.npz‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇtrain_direction_lstm_from_labels‚îÇ
‚îÇ  - DirectionLSTM (2L, 64H)‚îÇ
‚îÇ  - Early stopping (MCC)   ‚îÇ
‚îÇ  - Save model + metadata  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚ñº
models/direction_lstm_hybrid.pt
models/direction_lstm_hybrid.json

Step 5: Report Generation
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Model metadata     ‚îÇ
‚îÇ  Training metrics   ‚îÇ
‚îÇ  Confusion matrix   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
          ‚îÇ
          ‚ñº
reports/hybrid_v1.1_{symbol}_{timestamp}.md
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–û–¥–∏–Ω —Å–∫—Ä–∏–ø—Ç –¥–ª—è –≤—Å–µ–≥–æ –∫–æ–Ω–≤–µ–π–µ—Ä–∞:

```bash
python -m tools.train_and_backtest_hybrid \
    --symbol XAUUSD \
    --start 2024-01-01 \
    --end 2024-06-01 \
    --primary-tf M5 \
    --seq-len 50 \
    --epochs 20 \
    --batch-size 64 \
    --lr 1e-3
```

**–ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ `data/raw/XAUUSD/`
2. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–µ—Ç ‚Üí —ç–∫—Å–ø–æ—Ä—Ç –∏–∑ MT5 (M1, M5, M15, H1, H4)
3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫ —á–µ—Ä–µ–∑ HybridStrategy –±—ç–∫—Ç–µ—Å—Ç
4. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ (11 —Ñ–∏—á–µ–π, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, —Å–ø–ª–∏—Ç—ã)
5. –û–±—É—á–µ–Ω–∏–µ LSTM —Å early stopping
6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞ –≤ `reports/`

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö: ~2-5 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –æ–±—ä—ë–º–∞)
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫: ~3-10 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å–≤–µ—á–µ–π)
- –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞: ~1-2 –º–∏–Ω—É—Ç—ã
- –û–±—É—á–µ–Ω–∏–µ LSTM: ~5-15 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç epochs, GPU/CPU)
- **–ò—Ç–æ–≥–æ:** ~15-30 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞

### –û–ø—Ü–∏–∏ —Å–∫—Ä–∏–ø—Ç–∞

```bash
--symbol XAUUSD              # –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª
--start 2024-01-01           # –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (YYYY-MM-DD)
--end 2024-06-01             # –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (YYYY-MM-DD)
--timeframes M1 M5 M15 H1 H4 # –¢–∞–π–º—Ñ—Ä–µ–π–º—ã –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
--primary-tf M5              # –û—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º—Ñ—Ä–µ–π–º –¥–ª—è —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
--seq-len 50                 # –î–ª–∏–Ω–∞ LSTM –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
--epochs 20                  # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö
--batch-size 64              # –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
--lr 1e-3                    # Learning rate
--skip-export                # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ)
--skip-training              # –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –º–æ–¥–µ–ª—å)
```

---

## üß© –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. `tools/export_mt5_history.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ MetaTrader 5

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python -m tools.export_mt5_history \
    --symbol XAUUSD \
    --start 2024-01-01 \
    --end 2024-06-01 \
    --timeframes M1 M5 M15 H1 H4 \
    --output-dir data/raw \
    --format csv
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--symbol`: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: XAUUSD)
- `--start`: –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ (YYYY-MM-DD)
- `--end`: –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è (YYYY-MM-DD)
- `--timeframes`: –°–ø–∏—Å–æ–∫ —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: M1 M5 M15 H1 H4)
- `--output-dir`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: data/raw)
- `--format`: –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ (csv –∏–ª–∏ parquet, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: csv)

**–í—ã—Ö–æ–¥:**
- `data/raw/{symbol}/{timeframe}.csv` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞
- –§–æ—Ä–º–∞—Ç: timestamp, open, high, low, close, volume

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `mcp_servers.trading.market_data.get_ohlcv()` ‚Äî —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
- MetaTrader 5 –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω

---

### 2. `aimodule/training/generate_labels.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫ –∏–∑ —Ç—Ä–µ–π–¥–æ–≤ HybridStrategy

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python -m aimodule.training.generate_labels \
    --symbol XAUUSD \
    --primary-tf M5 \
    --data-dir data/raw \
    --output data/labels/direction_labels.csv
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--symbol`: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: XAUUSD)
- `--primary-tf`: –û—Å–Ω–æ–≤–Ω–æ–π —Ç–∞–π–º—Ñ—Ä–µ–π–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: M5)
- `--data-dir`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: data/raw)
- `--output`: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–µ—Ç–æ–∫ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: data/labels/direction_labels.csv)

**–í—ã—Ö–æ–¥:**
- `data/labels/direction_labels.csv` —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
  - `timestamp`: –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
  - `symbol`: –°–∏–º–≤–æ–ª
  - `regime`: –†–µ–∂–∏–º —Ä—ã–Ω–∫–∞ (trend_up/trend_down/range/volatile)
  - `direction_label`: 0=FLAT, 1=LONG, 2=SHORT
  - `pnl`: P&L —Ç—Ä–µ–π–¥–∞
  - `trade_id`: ID —Ç—Ä–µ–π–¥–∞
  - `entry_price`: –¶–µ–Ω–∞ –≤—Ö–æ–¥–∞
  - `exit_price`: –¶–µ–Ω–∞ –≤—ã—Ö–æ–¥–∞
  - `volume`: –û–±—ä—ë–º
  - `reason`: –ü—Ä–∏—á–∏–Ω–∞ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
1. –ó–∞–≥—Ä—É–∂–∞–µ—Ç –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ `data/raw/{symbol}/`
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç StrategyConfig, HybridStrategy, BacktestEngine
3. –ó–∞–ø—É—Å–∫–∞–µ—Ç –±—ç–∫—Ç–µ—Å—Ç —á–µ—Ä–µ–∑ `engine.run()`
4. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –≤—Å–µ —Ç—Ä–µ–π–¥—ã –∏–∑ `engine.trades`
5. –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Ç—Ä–µ–π–¥—ã –≤ –º–µ—Ç–∫–∏:
   - –í—Ö–æ–¥ –≤ LONG ‚Üí direction_label = 1
   - –í—Ö–æ–¥ –≤ SHORT ‚Üí direction_label = 2
   - –ù–µ—Ç —Å–∏–≥–Ω–∞–ª–∞ / FLAT ‚Üí direction_label = 0
6. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ CSV

**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `strategy/config.py` ‚Äî StrategyConfig
- `strategy/hybrid_strategy.py` ‚Äî HybridStrategy
- `strategy/backtest_engine.py` ‚Äî BacktestEngine
- `strategy/timeframe_selector.py` ‚Äî TimeframeSelector (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

---

### 3. `aimodule/training/prepare_direction_dataset.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –¥–ª—è LSTM (—Ñ–∏—á–∏ + –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python -m aimodule.training.prepare_direction_dataset \
    --labels data/labels/direction_labels.csv \
    --data-dir data/raw \
    --symbol XAUUSD \
    --timeframe M5 \
    --seq-len 50 \
    --output data/prepared/direction_dataset.npz
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--labels`: –ü—É—Ç—å –∫ –º–µ—Ç–∫–∞–º (CSV)
- `--data-dir`: –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å —Å—ã—Ä—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: data/raw)
- `--symbol`: –¢–æ—Ä–≥–æ–≤—ã–π —Å–∏–º–≤–æ–ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: XAUUSD)
- `--timeframe`: –¢–∞–π–º—Ñ—Ä–µ–π–º –¥–ª—è —Ñ–∏—á–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: M5)
- `--seq-len`: –î–ª–∏–Ω–∞ LSTM –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 50)
- `--output`: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞—Ç–∞—Å–µ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: data/prepared/direction_dataset.npz)

**–§–∏—á–∏ (11 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤):**
1. `close`: –¶–µ–Ω–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
2. `returns`: (close - close.shift(1)) / close.shift(1)
3. `log_returns`: log(close / close.shift(1))
4. `sma_fast`: SMA(10)
5. `sma_slow`: SMA(50)
6. `sma_ratio`: sma_fast / sma_slow
7. `atr`: Average True Range(14)
8. `atr_norm`: atr / close (–Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π ATR)
9. `rsi`: Relative Strength Index(14)
10. `bb_position`: (close - BB_lower) / (BB_upper - BB_lower)
11. `volume_ratio`: volume / SMA(volume, 20)

**–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:**
- StandardScaler –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∏—á–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
- Fit –Ω–∞ train, transform –Ω–∞ val –∏ test
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ `scaler_params` (mean, std –¥–ª—è –∫–∞–∂–¥–æ–π —Ñ–∏—á–∏)

**–°–ø–ª–∏—Ç—ã:**
- Train/Test: 80/20 (stratified by direction_label)
- Train/Val: 80/20 from train (stratified)
- –ò—Ç–æ–≥–æ: Train ~64%, Val ~16%, Test ~20%

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
- Sliding window: seq_len —Å–≤–µ—á–µ–π ‚Üí 1 –º–µ—Ç–∫–∞
- –§–æ—Ä–º–∞—Ç: (num_sequences, seq_len, n_features)
- –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ: –º–µ—Ç–∫–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–≤–µ—á–µ –≤ –æ–∫–Ω–µ

**–í—ã—Ö–æ–¥:**
- `data/prepared/direction_dataset.npz` (compressed numpy archive):
  - `X_train`: (N_train, seq_len, n_features)
  - `y_train`: (N_train,)
  - `X_val`: (N_val, seq_len, n_features)
  - `y_val`: (N_val,)
  - `X_test`: (N_test, seq_len, n_features)
  - `y_test`: (N_test,)
  - `feature_names`: List[str]
  - `scaler_mean`: (n_features,)
  - `scaler_std`: (n_features,)

---

### 4. `aimodule/training/train_direction_lstm_from_labels.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—É—á–µ–Ω–∏–µ Direction LSTM —Å early stopping

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python -m aimodule.training.train_direction_lstm_from_labels \
    --data data/prepared/direction_dataset.npz \
    --seq-len 50 \
    --epochs 20 \
    --batch-size 64 \
    --lr 1e-3 \
    --save-path models/direction_lstm_hybrid.pt
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--data`: –ü—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É (.npz)
- `--seq-len`: –î–ª–∏–Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–¥–æ–ª–∂–Ω–∞ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å prepare_direction_dataset)
- `--epochs`: –ú–∞–∫—Å–∏–º—É–º —ç–ø–æ—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 20)
- `--batch-size`: –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 64)
- `--lr`: Learning rate (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 1e-3)
- `--save-path`: –ü—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: models/direction_lstm_hybrid.pt)

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ DirectionLSTM:**
```python
DirectionLSTM(
  (lstm): LSTM(
    input_size=11,        # n_features
    hidden_size=64,       # hidden units
    num_layers=2,         # 2 LSTM layers
    dropout=0.3,          # dropout –º–µ–∂–¥—É —Å–ª–æ—è–º–∏
    batch_first=True
  )
  (fc): Linear(64 ‚Üí 3)    # 3 –∫–ª–∞—Å—Å–∞: FLAT, LONG, SHORT
)
```

**Training loop:**
- Optimizer: Adam (lr=1e-3 –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- Loss: CrossEntropyLoss
- Early stopping: patience=5 epochs
- –ú–µ—Ç—Ä–∏–∫–∞ –¥–ª—è early stopping: **MCC** (Matthews Correlation Coefficient)
- Device: CUDA if available, else CPU
- Seed: 42 (torch.manual_seed, np.random.seed, CUDA deterministic)

**–ú–µ—Ç—Ä–∏–∫–∏:**
- **Accuracy**: –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
- **F1 macro**: –°—Ä–µ–¥–Ω–∏–π F1 –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º (–≤–∞–∂–Ω–æ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
- **MCC**: Matthews Correlation Coefficient (–ª—É—á—à–µ Accuracy –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤)

**–í—ã—Ö–æ–¥:**
- `models/direction_lstm_hybrid.pt`: –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (torch.save)
- `models/direction_lstm_hybrid.json`: –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:
  ```json
  {
    "model_type": "DirectionLSTM",
    "training_date": "2025-01-30T12:00:00",
    "seq_len": 50,
    "n_features": 11,
    "n_classes": 3,
    "hidden_size": 64,
    "num_layers": 2,
    "dropout": 0.3,
    "epochs_trained": 15,
    "best_val_mcc": 0.6789,
    "test_metrics": {
      "accuracy": 0.75,
      "f1_macro": 0.72,
      "mcc": 0.68
    },
    "confusion_matrix": "[[...]]\n",
    "feature_names": ["close", "returns", ...],
    "scaler_mean": [...],
    "scaler_std": [...]
  }
  ```

---

### 5. `tools/train_and_backtest_hybrid.py`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–∞–≤–Ω—ã–π –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç –≤–µ—Å—å –∫–æ–Ω–≤–µ–π–µ—Ä

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –°–º. [–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç](#–±—ã—Å—Ç—Ä—ã–π-—Å—Ç–∞—Ä—Ç)

**Workflow:**
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
   - –ï—Å–ª–∏ `data/raw/{symbol}` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –ø—É—Å—Ç–æ ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç `export_mt5_history.py`
   - –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –µ—Å—Ç—å ‚Üí –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç (–º–æ–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ `--skip-export`)

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫:**
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç `generate_labels.py` —á–µ—Ä–µ–∑ subprocess
   - –ü–µ—Ä–µ–¥–∞—ë—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã: symbol, primary-tf, data-dir

3. **–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞:**
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç `prepare_direction_dataset.py`
   - –ü–µ—Ä–µ–¥–∞—ë—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã: labels, data-dir, symbol, timeframe, seq-len

4. **–û–±—É—á–µ–Ω–∏–µ LSTM:**
   - –ó–∞–ø—É—Å–∫–∞–µ—Ç `train_direction_lstm_from_labels.py`
   - –ü–µ—Ä–µ–¥–∞—ë—Ç –∞—Ä–≥—É–º–µ–Ω—Ç—ã: data, seq-len, epochs, batch-size, lr, save-path

5. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–∞:**
   - –°–æ–∑–¥–∞—ë—Ç Markdown –æ—Ç—á—ë—Ç –≤ `reports/hybrid_v1.1_{symbol}_{timestamp}.md`
   - –í–∫–ª—é—á–∞–µ—Ç: config, training metrics, confusion matrix, paths

**–û–ø—Ü–∏–∏:**
- `--skip-export`: –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ)
- `--skip-training`: –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —à–∞–≥–∏ –æ–±—É—á–µ–Ω–∏—è (—Ç–æ–ª—å–∫–æ –æ—Ç—á—ë—Ç)

**–í—ã–≤–æ–¥:**
- –ü–æ–¥—Ä–æ–±–Ω—ã–π –ª–æ–≥ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- –°–≤–æ–¥–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü—É—Ç–∏ –∫ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–º —Ñ–∞–π–ª–∞–º
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤ (backtest, deploy)

---

## üìö –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### –®–∞–≥ 1: –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ MT5

**–¶–µ–ª—å:** –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è

**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- MetaTrader 5 –∑–∞–ø—É—â–µ–Ω
- –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º MetaQuotes-Demo (–∏–ª–∏ –¥—Ä—É–≥–æ–π)
- –î–æ—Å—Ç—É–ø –∫ —Å–∏–º–≤–æ–ª—É XAUUSD

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python -m tools.export_mt5_history \
    --symbol XAUUSD \
    --start 2024-01-01 \
    --end 2024-06-01 \
    --timeframes M1 M5 M15 H1 H4
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è MT5 —á–µ—Ä–µ–∑ `MetaTrader5.initialize()`
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–∏–º–≤–æ–ª–∞
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–∞–π–º—Ñ—Ä–µ–π–º–∞:
   - –í—ã–∑–æ–≤ `get_ohlcv(symbol, timeframe, start_date, end_date)`
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `data/raw/{symbol}/{timeframe}.csv`
4. –í—ã–≤–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–≤–µ—á–µ–π, –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç

**–§–æ—Ä–º–∞—Ç CSV:**
```csv
timestamp,open,high,low,close,volume
2024-01-01T00:00:00,2050.0,2055.0,2048.0,2053.0,1000.0
2024-01-01T00:05:00,2053.0,2058.0,2051.0,2056.0,1200.0
...
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **MT5 –Ω–µ –∑–∞–ø—É—â–µ–Ω**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ MT5 –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É
- **–°–∏–º–≤–æ–ª –Ω–µ –Ω–∞–π–¥–µ–Ω**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Å–∏–º–≤–æ–ª–∞ (XAUUSD, XAUUSD., GOLD, etc.)
- **–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç, –≤–æ–∑–º–æ–∂–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –Ω–µ—Ç —Ç–∞–∫–∏—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

### –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ—Ç–æ–∫

**–¶–µ–ª—å:** –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–π–¥—ã –∏–∑ HybridStrategy

**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–∞–Ω–Ω—ã–µ –∏–∑ –®–∞–≥–∞ 1 –≤ `data/raw/{symbol}/`
- HybridStrategy –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ (config.py)

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python -m aimodule.training.generate_labels \
    --symbol XAUUSD \
    --primary-tf M5 \
    --data-dir data/raw
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤ –∏–∑ `data/raw/{symbol}/`
2. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è StrategyConfig —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏–∑ config.py
3. –°–æ–∑–¥–∞–Ω–∏–µ HybridStrategy instance
4. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ BacktestEngine
5. –ó–∞–ø—É—Å–∫ –±—ç–∫—Ç–µ—Å—Ç–∞: `engine.run()`
6. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç—Ä–µ–π–¥–æ–≤ –∏–∑ `engine.trades`
7. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –≤ DataFrame —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
   - timestamp (–≤—Ä–µ–º—è –≤—Ö–æ–¥–∞)
   - symbol
   - regime (—Ä–µ–∂–∏–º —Ä—ã–Ω–∫–∞ –Ω–∞ –º–æ–º–µ–Ω—Ç –≤—Ö–æ–¥–∞)
   - direction_label (0/1/2)
   - pnl
   - entry_price, exit_price, volume
   - reason (–ø—Ä–∏—á–∏–Ω–∞ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞)
8. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `data/labels/direction_labels.csv`

**–§–æ—Ä–º–∞—Ç labels CSV:**
```csv
timestamp,symbol,regime,direction_label,pnl,trade_id,entry_price,exit_price,volume,reason
2024-01-01T10:00:00,XAUUSD,trend_up,1,50.0,0,2050.0,2055.0,0.01,Trend breakout
2024-01-01T12:30:00,XAUUSD,range,0,0.0,1,2053.0,2053.0,0.0,No signal
...
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–µ—Ä–≤—ã–µ —Å—Ç—Ä–æ–∫–∏
head data/labels/direction_labels.csv

# –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–µ—Ç–æ–∫
wc -l data/labels/direction_labels.csv

# –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∞—Å—Å–æ–≤
cat data/labels/direction_labels.csv | cut -d',' -f4 | sort | uniq -c
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **–ù–µ—Ç —Ç—Ä–µ–π–¥–æ–≤**: HybridStrategy –Ω–µ –Ω–∞—à–ª–∞ –≤—Ö–æ–¥—ã (—Å–ª–∏—à–∫–æ–º –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–ª–∏ –ø–ª–æ—Ö–∏–µ –¥–∞–Ω–Ω—ã–µ)
- **–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ FLAT**: –£–≤–µ–ª–∏—á—å—Ç–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–ª–∏ —Ä–∞—Å—à–∏—Ä—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç
- **KeyError –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ —Ç–∞–π–º—Ñ—Ä–µ–π–º—ã –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç –≤ `data/raw/{symbol}/`

---

### –®–∞–≥ 3: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

**–¶–µ–ª—å:** –°–æ–∑–¥–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è LSTM —Å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–µ–π

**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Labels –∏–∑ –®–∞–≥–∞ 2 –≤ `data/labels/direction_labels.csv`
- OHLCV –¥–∞–Ω–Ω—ã–µ –¥–ª—è primary-tf –≤ `data/raw/{symbol}/{timeframe}.csv`

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python -m aimodule.training.prepare_direction_dataset \
    --labels data/labels/direction_labels.csv \
    --data-dir data/raw \
    --symbol XAUUSD \
    --timeframe M5 \
    --seq-len 50
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ—Ç–æ–∫ –∏–∑ CSV
2. –ó–∞–≥—Ä—É–∑–∫–∞ OHLCV –¥–ª—è primary-tf (M5)
3. Feature engineering:
   - –†–∞—Å—á—ë—Ç 11 –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ (—Å–º. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã))
   - –£–¥–∞–ª–µ–Ω–∏–µ NaN (first seq_len + indicator periods)
4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π:
   - Sliding window: –∫–∞–∂–¥—ã–µ seq_len —Å–≤–µ—á–µ–π ‚Üí 1 –º–µ—Ç–∫–∞
   - –í—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ timestamp
5. –°–ø–ª–∏—Ç—ã:
   - Train/Test: 80/20 (stratified)
   - Train/Val: 80/20 from train (stratified)
6. –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è:
   - StandardScaler –Ω–∞ train (fit)
   - Transform –Ω–∞ val –∏ test
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `.npz`:
   - Arrays: X_train, y_train, X_val, y_val, X_test, y_test
   - Metadata: feature_names, scaler_mean, scaler_std

**–§–æ—Ä–º–∞—Ç .npz:**
```python
data = np.load('data/prepared/direction_dataset.npz', allow_pickle=True)

data['X_train'].shape  # (N_train, 50, 11)
data['y_train'].shape  # (N_train,)
data['X_val'].shape    # (N_val, 50, 11)
data['X_test'].shape   # (N_test, 50, 11)

data['feature_names']  # ['close', 'returns', ...]
data['scaler_mean']    # [mean_feat1, mean_feat2, ...]
data['scaler_std']     # [std_feat1, std_feat2, ...]
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
```python
import numpy as np

data = np.load('data/prepared/direction_dataset.npz', allow_pickle=True)

print("Train samples:", len(data['X_train']))
print("Val samples:", len(data['X_val']))
print("Test samples:", len(data['X_test']))
print("Features:", data['feature_names'])
print("Class distribution (train):", np.bincount(data['y_train']))
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **Not enough samples**: –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–µ—Ç–æ–∫ –ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ NaN (—É–≤–µ–ª–∏—á—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ seq_len)
- **Class imbalance**: –û–¥–∏–Ω –∫–ª–∞—Å—Å –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç (> 80%) ‚Üí –ø–ª–æ—Ö–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –∏–ª–∏ –Ω—É–∂–Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤
- **Memory error**: –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π (—É–º–µ–Ω—å—à–∏—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç –∏–ª–∏ —É–≤–µ–ª–∏—á—å—Ç–µ seq_len)

---

### –®–∞–≥ 4: –û–±—É—á–µ–Ω–∏–µ LSTM

**–¶–µ–ª—å:** –û–±—É—á–∏—Ç—å Direction LSTM —Å early stopping

**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–∞—Ç–∞—Å–µ—Ç –∏–∑ –®–∞–≥–∞ 3 –≤ `data/prepared/direction_dataset.npz`
- PyTorch —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) CUDA –¥–ª—è GPU training

**–ö–æ–º–∞–Ω–¥–∞:**
```bash
python -m aimodule.training.train_direction_lstm_from_labels \
    --data data/prepared/direction_dataset.npz \
    --seq-len 50 \
    --epochs 20 \
    --batch-size 64 \
    --lr 1e-3
```

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞ –∏–∑ .npz
2. –°–æ–∑–¥–∞–Ω–∏–µ PyTorch DataLoader –¥–ª—è train/val/test
3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è DirectionLSTM(input_size=11, hidden_size=64, num_layers=2, dropout=0.3)
4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Adam optimizer (lr=1e-3)
5. Training loop:
   - –î–ª—è –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–∏:
     - Train: forward ‚Üí loss ‚Üí backward ‚Üí update weights
     - Val: evaluate (Acc, F1, MCC)
     - Early stopping: –µ—Å–ª–∏ val MCC –Ω–µ —É–ª—É—á—à–∞–µ—Ç—Å—è patience=5 —ç–ø–æ—Ö ‚Üí stop
6. Test evaluation: —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –Ω–∞ test set
7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ:
   - `models/direction_lstm_hybrid.pt`: torch.save(model.state_dict())
   - `models/direction_lstm_hybrid.json`: metadata (metrics, confusion matrix, etc.)

**–í—ã–≤–æ–¥ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:**
```
Epoch 1/20
----------
Train Loss: 0.8456 | Acc: 0.55 | F1: 0.52 | MCC: 0.25
Val Loss: 0.7890 | Acc: 0.58 | F1: 0.55 | MCC: 0.30
‚úì Best model saved (Val MCC: 0.30)

Epoch 2/20
----------
Train Loss: 0.7123 | Acc: 0.62 | F1: 0.59 | MCC: 0.38
Val Loss: 0.7012 | Acc: 0.64 | F1: 0.61 | MCC: 0.42
‚úì Best model saved (Val MCC: 0.42)

...

Epoch 15/20
----------
Train Loss: 0.4567 | Acc: 0.78 | F1: 0.75 | MCC: 0.65
Val Loss: 0.6234 | Acc: 0.70 | F1: 0.68 | MCC: 0.58

Early stopping triggered (no improvement for 5 epochs)
Best Val MCC: 0.68 (epoch 10)

Test Results:
Accuracy: 0.72
F1 macro: 0.70
MCC: 0.65

Confusion Matrix:
[[100  10   5]  # FLAT
 [ 15  80   8]  # LONG
 [  8  12  75]] # SHORT
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –º–µ—Ç—Ä–∏–∫:**
- **Accuracy > 0.70**: –•–æ—Ä–æ—à–æ –¥–ª—è 3-–∫–ª–∞—Å—Å–æ–≤–æ–π –∑–∞–¥–∞—á–∏
- **F1 macro > 0.65**: –ú–æ–¥–µ–ª—å –Ω–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –º–∏–Ω–æ—Ä–Ω—ã–µ –∫–ª–∞—Å—Å—ã
- **MCC > 0.60**: –°–∏–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é (MCC [-1, 1], –≥–¥–µ 1 = –∏–¥–µ–∞–ª—å–Ω–æ)

**–ü—Ä–æ–±–ª–µ–º—ã:**
- **Overfitting**: Train Acc >> Val Acc (—É–≤–µ–ª–∏—á—å—Ç–µ dropout, –¥–æ–±–∞–≤—å—Ç–µ weight decay, —É–º–µ–Ω—å—à–∏—Ç–µ epochs)
- **Underfitting**: Train/Val Acc –Ω–∏–∑–∫–∏–µ (—É–≤–µ–ª–∏—á—å—Ç–µ hidden_size, num_layers, —É–º–µ–Ω—å—à–∏—Ç–µ dropout, —É–≤–µ–ª–∏—á—å—Ç–µ epochs)
- **No improvement**: Val MCC –Ω–µ —Ä–∞—Å—Ç—ë—Ç (–ø–ª–æ—Ö–∏–µ —Ñ–∏—á–∏, –ø–ª–æ—Ö–∏–µ –¥–∞–Ω–Ω—ã–µ, –∏–ª–∏ task —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–∞—è)
- **CUDA out of memory**: –£–º–µ–Ω—å—à–∏—Ç–µ batch_size (64 ‚Üí 32 ‚Üí 16)

---

### –®–∞–≥ 5: –ë—ç–∫—Ç–µ—Å—Ç —Å –Ω–æ–≤–æ–π –º–æ–¥–µ–ª—å—é

**–¶–µ–ª—å:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫ –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –±—ç–∫—Ç–µ—Å—Ç–µ

**–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∏–∑ –®–∞–≥–∞ 4: `models/direction_lstm_hybrid.pt`
- –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π config –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

**–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ config:**
```python
# strategy/config.py –∏–ª–∏ demo_backtest_hybrid.py

config = StrategyConfig(
    # ...
    ai_direction_model_path="models/direction_lstm_hybrid.pt",  # <-- –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å
    # ...
)
```

**–ó–∞–ø—É—Å–∫ –±—ç–∫—Ç–µ—Å—Ç–∞:**
```bash
python demo_backtest_hybrid.py
```

**–ò–ª–∏ —á–µ—Ä–µ–∑ visualize_metrics:**
```bash
python visualize_metrics.py
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å:**
- **Win Rate**: –ü—Ä–æ—Ü–µ–Ω—Ç –ø—Ä–∏–±—ã–ª—å–Ω—ã—Ö —Ç—Ä–µ–π–¥–æ–≤ (> 50% —Ö–æ—Ä–æ—à–æ)
- **Profit Factor**: Total profit / Total loss (> 1.5 –æ—Ç–ª–∏—á–Ω–æ)
- **Sharpe Ratio**: Risk-adjusted returns (> 1.0 —Ö–æ—Ä–æ—à–æ)
- **Max Drawdown**: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ—Å–∞–¥–∫–∞ (< 20% –ø—Ä–∏–µ–º–ª–µ–º–æ)
- **Trade count**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–µ–π–¥–æ–≤ (> 100 –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏)

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ:**
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫—Ç–µ—Å—Ç —Å **—Å—Ç–∞—Ä–æ–π** –º–æ–¥–µ–ª—å—é (`models/direction_lstm.pt`)
- –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫—Ç–µ—Å—Ç —Å **–Ω–æ–≤–æ–π** –º–æ–¥–µ–ª—å—é (`models/direction_lstm_hybrid.pt`)
- –°—Ä–∞–≤–Ω–∏—Ç–µ –º–µ—Ç—Ä–∏–∫–∏ (Win Rate, Profit Factor, Sharpe Ratio)
- –ï—Å–ª–∏ –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å –ª—É—á—à–µ ‚Üí deploy, –∏–Ω–∞—á–µ ‚Üí –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

```
Golden Breeze/
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îú‚îÄ‚îÄ raw/                        # –°—ã—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ MT5
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ XAUUSD/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ M1.csv              # ~150,000 —Å–≤–µ—á–µ–π –∑–∞ 6 –º–µ—Å—è—Ü–µ–≤
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ M5.csv              # ~30,000 —Å–≤–µ—á–µ–π
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ M15.csv             # ~10,000 —Å–≤–µ—á–µ–π
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ H1.csv              # ~2,500 —Å–≤–µ—á–µ–π
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ H4.csv              # ~600 —Å–≤–µ—á–µ–π
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ labels/                     # –ú–µ—Ç–∫–∏ –∏–∑ HybridStrategy
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ direction_labels_XAUUSD.csv  # ~5,000 —Ç—Ä–µ–π–¥–æ–≤
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ prepared/                   # –ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞—Ç–∞—Å–µ—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ direction_dataset_XAUUSD.npz  # ~4,500 sequences (–ø–æ—Å–ª–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ NaN)
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ direction_lstm_hybrid_XAUUSD.pt   # –û–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (~500 KB)
‚îÇ   ‚îú‚îÄ‚îÄ direction_lstm_hybrid_XAUUSD.json # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (~5 KB)
‚îÇ   ‚îú‚îÄ‚îÄ regime_ml.pkl                     # Legacy Regime ML
‚îÇ   ‚îî‚îÄ‚îÄ direction_lstm.pt                 # Legacy Direction LSTM
‚îÇ
‚îî‚îÄ‚îÄ reports/
    ‚îî‚îÄ‚îÄ hybrid_v1.1_XAUUSD_20250130_120000.md  # –û—Ç—á—ë—Ç –æ–±—É—á–µ–Ω–∏—è
```

**–†–∞–∑–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤ (–ø—Ä–∏–º–µ—Ä–Ω–æ):**
- `M5.csv` (6 –º–µ—Å—è—Ü–µ–≤): ~5 MB
- `direction_labels.csv`: ~500 KB
- `direction_dataset.npz`: ~50 MB (compressed)
- `direction_lstm_hybrid.pt`: ~500 KB

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ü–µ–Ω–∫–∞

### –ú–µ—Ç—Ä–∏–∫–∏ –æ–±—É—á–µ–Ω–∏—è

1. **Accuracy**:
   - –§–æ—Ä–º—É–ª–∞: (TP + TN) / (TP + TN + FP + FN)
   - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: –î–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
   - –¶–µ–ª—å: > 0.70 –¥–ª—è 3-–∫–ª–∞—Å—Å–æ–≤–æ–π –∑–∞–¥–∞—á–∏

2. **F1 macro**:
   - –§–æ—Ä–º—É–ª–∞: avg(F1_class0, F1_class1, F1_class2)
   - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: –°—Ä–µ–¥–Ω–µ–µ F1 –ø–æ –≤—Å–µ–º –∫–ª–∞—Å—Å–∞–º (–≤–∞–∂–Ω–æ –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)
   - –¶–µ–ª—å: > 0.65

3. **MCC (Matthews Correlation Coefficient)**:
   - –§–æ—Ä–º—É–ª–∞: (TP*TN - FP*FN) / sqrt((TP+FP)(TP+FN)(TN+FP)(TN+FN))
   - –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è: –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è–º–∏ –∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é [-1, 1]
   - –¶–µ–ª—å: > 0.60 (–æ—Ç–ª–∏—á–Ω–æ), > 0.40 (—Ö–æ—Ä–æ—à–æ), > 0.20 (–ø—Ä–∏–µ–º–ª–µ–º–æ)
   - **–ü–æ—á–µ–º—É MCC?**: –õ—É—á—à–µ Accuracy –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —É—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ 4 –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞ confusion matrix

### Confusion Matrix

```
Predicted ‚Üí
Actual ‚Üì      FLAT  LONG  SHORT
FLAT         [[100   10     5]
LONG           15   80     8]
SHORT           8   12    75]]
```

**–ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è:**
- **Diagonal (100, 80, 75)**: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
- **Off-diagonal**: –û—à–∏–±–∫–∏
  - `FLAT ‚Üí LONG (10)`: –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–ª–∞ LONG, –Ω–æ –±—ã–ª–æ FLAT (–ª–æ–∂–Ω—ã–π —Å–∏–≥–Ω–∞–ª)
  - `LONG ‚Üí FLAT (15)`: –ú–æ–¥–µ–ª—å –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∞ LONG (—É–ø—É—â–µ–Ω–Ω–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å)

**–•–æ—Ä–æ—à–∞—è –º–∞—Ç—Ä–∏—Ü–∞:**
- Diagonal > 70% –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
- Off-diagonal –æ—à–∏–±–∫–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã (–Ω–µ—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ bias)

### –ú–µ—Ç—Ä–∏–∫–∏ –±—ç–∫—Ç–µ—Å—Ç–∞

–ü–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è –∑–∞–ø—É—Å—Ç–∏—Ç–µ –±—ç–∫—Ç–µ—Å—Ç –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Win Rate**: > 50% (60%+ –æ—Ç–ª–∏—á–Ω–æ)
2. **Profit Factor**: > 1.5 (2.0+ –æ—Ç–ª–∏—á–Ω–æ)
3. **Sharpe Ratio**: > 1.0 (1.5+ –æ—Ç–ª–∏—á–Ω–æ)
4. **Max Drawdown**: < 20% (< 10% –æ—Ç–ª–∏—á–Ω–æ)
5. **Total Profit**: –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π (–æ—á–µ–≤–∏–¥–Ω–æ)
6. **Trade Count**: > 100 –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏

**–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å baseline:**
- –ï—Å–ª–∏ –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å –Ω–µ –ª—É—á—à–µ baseline ‚Üí –ø–µ—Ä–µ—Å–º–æ—Ç—Ä–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ï—Å–ª–∏ –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å –ª—É—á—à–µ –Ω–∞ train, –Ω–æ —Ö—É–∂–µ –Ω–∞ test ‚Üí overfitting

---

## üêõ Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: MT5 –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
```
ERROR: Failed to initialize MT5
```

**–†–µ—à–µ–Ω–∏–µ:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ MetaTrader 5
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É (MetaQuotes-Demo –∏–ª–∏ –¥—Ä—É–≥–æ–π)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ MT5 –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç Python API (Options ‚Üí Allow DLL imports)

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ—Ç —Ç—Ä–µ–π–¥–æ–≤ –≤ labels

**–°–∏–º–ø—Ç–æ–º—ã:**
```
WARNING: No trades found in backtest
Empty labels CSV
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Å–ª–∏—à–∫–æ–º –∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω–∞—è (–≤—ã—Å–æ–∫–∏–µ –ø–æ—Ä–æ–≥–∏ –¥–ª—è –≤—Ö–æ–¥–∞)
- –ü–ª–æ—Ö–∏–µ/–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π primary-tf (—Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π –∏–ª–∏ —Å–ª–∏—à–∫–æ–º –º–∞–ª—ã–π)

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –≤ `strategy/config.py`:
   - –£–º–µ–Ω—å—à–∏—Ç–µ `ai_confidence_threshold` (0.75 ‚Üí 0.60)
   - –£–≤–µ–ª–∏—á—å—Ç–µ `max_positions` (3 ‚Üí 5)
   - –£–º–µ–Ω—å—à–∏—Ç–µ `min_entry_gap` (10 ‚Üí 5)
2. –†–∞—Å—à–∏—Ä—å—Ç–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç (1 –º–µ—Å—è—Ü ‚Üí 6 –º–µ—Å—è—Ü–µ–≤)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥–æ–π primary-tf (M5 ‚Üí M15)

---

### –ü—Ä–æ–±–ª–µ–º–∞: Class imbalance (–æ–¥–∏–Ω –∫–ª–∞—Å—Å –¥–æ–º–∏–Ω–∏—Ä—É–µ—Ç)

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Class distribution: [3000, 500, 500]  # FLAT >> LONG, SHORT
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∞–ª–æ —Å–∏–≥–Ω–∞–ª–æ–≤ (–º–Ω–æ–≥–æ FLAT –ø–µ—Ä–∏–æ–¥–æ–≤)
- –†—ã–Ω–æ–∫ –±—ã–ª –≤ range –±–æ–ª—å—à—É—é —á–∞—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. **Undersampling**: –£–º–µ–Ω—å—à–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ FLAT –æ–±—Ä–∞–∑—Ü–æ–≤
   ```python
   # –í prepare_direction_dataset.py
   # –û—Å—Ç–∞–≤—å—Ç–µ —Ç–æ–ª—å–∫–æ 50% FLAT –æ–±—Ä–∞–∑—Ü–æ–≤
   df_flat = df[df['direction_label'] == 0].sample(frac=0.5)
   df_signals = df[df['direction_label'] != 0]
   df = pd.concat([df_flat, df_signals])
   ```

2. **Class weights**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ class_weight –≤ loss function
   ```python
   # –í train_direction_lstm_from_labels.py
   from sklearn.utils.class_weight import compute_class_weight
   
   class_weights = compute_class_weight('balanced', classes=[0,1,2], y=y_train)
   criterion = nn.CrossEntropyLoss(weight=torch.tensor(class_weights))
   ```

3. **Focal Loss**: –ó–∞–º–µ–Ω–∏—Ç–µ CrossEntropyLoss –Ω–∞ Focal Loss (—Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ hard examples)

---

### –ü—Ä–æ–±–ª–µ–º–∞: Overfitting (Train Acc >> Val Acc)

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Epoch 20/20
Train Acc: 0.95 | Val Acc: 0.60
Test Acc: 0.58
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ú–æ–¥–µ–ª—å –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç train –¥–∞–Ω–Ω—ã–µ, –Ω–µ –æ–±–æ–±—â–∞–µ—Ç –Ω–∞ val/test
- –°–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∞—è –º–æ–¥–µ–ª—å (hidden_size, num_layers)
- –°–ª–∏—à–∫–æ–º –º–∞–ª–æ regularization (dropout)

**–†–µ—à–µ–Ω–∏–µ:**
1. **–£–≤–µ–ª–∏—á—å—Ç–µ dropout**: 0.3 ‚Üí 0.4 ‚Üí 0.5
   ```python
   # –í DirectionLSTM
   self.lstm = nn.LSTM(..., dropout=0.5)
   ```

2. **–î–æ–±–∞–≤—å—Ç–µ weight decay**:
   ```python
   optimizer = torch.optim.Adam(model.parameters(), lr=1e-3, weight_decay=1e-4)
   ```

3. **–£–º–µ–Ω—å—à–∏—Ç–µ –º–æ–¥–µ–ª—å**:
   ```python
   # hidden_size: 64 ‚Üí 32
   # num_layers: 2 ‚Üí 1
   ```

4. **–£–≤–µ–ª–∏—á—å—Ç–µ –¥–∞–Ω–Ω—ã–µ**: –ë–æ–ª—å—à–µ –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç, –±–æ–ª—å—à–µ —Ç—Ä–µ–π–¥–æ–≤

5. **Early stopping**: patience=5 ‚Üí patience=3 (stop —Ä–∞–Ω—å—à–µ)

---

### –ü—Ä–æ–±–ª–µ–º–∞: Underfitting (Train/Val Acc –æ–±–µ –Ω–∏–∑–∫–∏–µ)

**–°–∏–º–ø—Ç–æ–º—ã:**
```
Epoch 20/20
Train Acc: 0.55 | Val Acc: 0.54
Test Acc: 0.53
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ú–æ–¥–µ–ª—å —Å–ª–∏—à–∫–æ–º –ø—Ä–æ—Å—Ç–∞—è (–Ω–µ –º–æ–∂–µ—Ç –≤—ã—É—á–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
- –ü–ª–æ—Ö–∏–µ —Ñ–∏—á–∏ (–Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é)
- Task —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–∞—è (–Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å direction –∏–∑ OHLCV)

**–†–µ—à–µ–Ω–∏–µ:**
1. **–£–≤–µ–ª–∏—á—å—Ç–µ –º–æ–¥–µ–ª—å**:
   ```python
   # hidden_size: 64 ‚Üí 128
   # num_layers: 2 ‚Üí 3
   ```

2. **–£–º–µ–Ω—å—à–∏—Ç–µ dropout**: 0.3 ‚Üí 0.2 ‚Üí 0.1

3. **–£–≤–µ–ª–∏—á—å—Ç–µ epochs**: 20 ‚Üí 50 (–º–æ–¥–µ–ª—å –µ—â—ë –Ω–µ —Å–æ—à–ª–∞—Å—å)

4. **–î–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ —Ñ–∏—á–µ–π**: Bollinger Bands width, MACD, Stochastic, etc.

5. **–ü–µ—Ä–µ—Å–º–æ—Ç—Ä–∏—Ç–µ task**: –í–æ–∑–º–æ–∂–Ω–æ, 3-–∫–ª–∞—Å—Å–æ–≤–∞—è –∑–∞–¥–∞—á–∞ —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω–∞ ‚Üí –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –±–∏–Ω–∞—Ä–Ω—É—é (LONG vs SHORT, –∏–≥–Ω–æ—Ä–∏—Ä—É—è FLAT)

---

### –ü—Ä–æ–±–ª–µ–º–∞: CUDA out of memory

**–°–∏–º–ø—Ç–æ–º—ã:**
```
RuntimeError: CUDA out of memory. Tried to allocate 256 MiB
```

**–†–µ—à–µ–Ω–∏–µ:**
1. **–£–º–µ–Ω—å—à–∏—Ç–µ batch_size**: 64 ‚Üí 32 ‚Üí 16 ‚Üí 8
2. **–£–º–µ–Ω—å—à–∏—Ç–µ seq_len**: 50 ‚Üí 30 (–º–µ–Ω—å—à–µ –ø–∞–º—è—Ç–∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CPU**: `--device cpu` (–º–µ–¥–ª–µ–Ω–Ω–µ–µ, –Ω–æ –±–µ–∑ memory issues)
4. **–û—á–∏—Å—Ç–∏—Ç–µ GPU cache**:
   ```python
   torch.cuda.empty_cache()
   ```

---

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ inference

**–°–∏–º–ø—Ç–æ–º—ã:**
```
RuntimeError: Error loading model state_dict
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å (n_features, hidden_size, etc.)
- –§–∞–π–ª –º–æ–¥–µ–ª–∏ –ø–æ–≤—Ä–µ–∂–¥—ë–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ metadata JSON:
   ```bash
   cat models/direction_lstm_hybrid.json
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ n_features, seq_len —Å–æ–≤–ø–∞–¥–∞—é—Ç –ø—Ä–∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–µ
3. –ü–µ—Ä–µ–æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å, –µ—Å–ª–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å

---

## üéì Best Practices

### 1. Data Quality
- **–ú–∏–Ω–∏–º—É–º 6 –º–µ—Å—è—Ü–µ–≤** –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
- **–ú–∏–Ω–∏–º—É–º 1000 —Ç—Ä–µ–π–¥–æ–≤** –≤ labels (–ª—É—á—à–µ 5000+)
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–∞ gaps –≤ –¥–∞–Ω–Ω—ã—Ö (weekends, holidays)

### 2. Feature Engineering
- –î–æ–±–∞–≤–ª—è–π—Ç–µ domain-specific —Ñ–∏—á–∏ (–Ω–µ —Ç–æ–ª—å–∫–æ OHLCV)
- –ù–æ—Ä–º–∞–ª–∏–∑—É–π—Ç–µ **–≤—Å–µ–≥–¥–∞** (StandardScaler –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)
- –ò–∑–±–µ–≥–∞–π—Ç–µ look-ahead bias (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—É–¥—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ)

### 3. Training
- **Early stopping** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ (patience=5)
- **Stratified splits** –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **Seed=42** –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ **metadata** –≤–º–µ—Å—Ç–µ —Å –º–æ–¥–µ–ª—å—é

### 4. Evaluation
- **MCC > Accuracy** –¥–ª—è –Ω–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **confusion matrix** –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –æ—à–∏–±–æ–∫
- **Backtest** –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–æ—Å–ª–µ –æ–±—É—á–µ–Ω–∏—è (–Ω–µ –¥–æ–≤–µ—Ä—è–π—Ç–µ —Ç–æ–ª—å–∫–æ train metrics)

### 5. Deployment
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä—É–π—Ç–µ –º–æ–¥–µ–ª–∏ (direction_lstm_v1, v2, etc.)
- –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ **scaler params** –≤–º–µ—Å—Ç–µ —Å –º–æ–¥–µ–ª—å—é
- –õ–æ–≥–∏—Ä—É–π—Ç–µ **metadata** –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ (training_date, metrics, etc.)

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–í–æ–ø—Ä–æ—Å—ã?** –°–æ–∑–¥–∞–π—Ç–µ issue –≤ GitHub –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –Ω–∞ support@goldenbreeze.ai

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- README.md ‚Äî –≥–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- MULTITIMEFRAME_SPECIFICATION.md ‚Äî –º—É–ª—å—Ç–∏—Ç–∞–π–º—Ñ—Ä–µ–π–º–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
- strategy/README.md ‚Äî –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è HybridStrategy

---

**–í–µ—Ä—Å–∏—è:** 1.1  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-01-30  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ COMPLETE

---

*Generated by Golden Breeze Training Pipeline v1.1*
